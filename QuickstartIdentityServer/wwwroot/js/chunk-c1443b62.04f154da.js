(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1443b62"],{"0afe":function(e,n,t){"use strict";t.r(n);var c=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("el-scrollbar",{attrs:{"wrap-class":"scrollbar-wrapper-y"}},[t("div",[t("div",{staticClass:"flex"},[t("span",[e._v("选择系统 :")]),t("el-select",{attrs:{size:"mini",filterable:"",placeholder:"请选择系统"},on:{change:function(n){e.currentPage=1,e.flush()}},model:{value:e.code,callback:function(n){e.code=n},expression:"code"}},[t("el-option",{attrs:{label:"全部",value:""}}),e._l(e.apps,function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})],2),t("div",{staticClass:"flex1"}),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.back}},[e._v("关闭并返回")]),t("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.save}},[e._v("保存")])],1),t("el-collapse",{model:{value:e.activecodes,callback:function(n){e.activecodes=n},expression:"activecodes"}},e._l(e.filterapps,function(n){return t("el-collapse-item",{key:n.code,attrs:{name:n.code}},[t("template",{slot:"title"},[t("el-checkbox",{attrs:{indeterminate:n.indeterminate},on:{change:function(t){e.checkapp(n)}},model:{value:n.checked,callback:function(t){e.$set(n,"checked",t)},expression:"app.checked"}}),t("span",[e._v(e._s(n.name))])],1),e._l(n.modules,function(c){return t("div",{key:c.id,staticClass:"collapse-content"},[t("el-checkbox",{attrs:{indeterminate:c.indeterminate},on:{change:function(t){e.checkmodule(c,n)}},model:{value:c.checked,callback:function(n){e.$set(c,"checked",n)},expression:"m.checked"}},[e._v(e._s(c.name)+":")]),e._l(c.permissions,function(i){return t("el-checkbox",{key:i.id,on:{change:function(t){e.checkmoduleAll(c,n)}},model:{value:i.checked,callback:function(n){e.$set(i,"checked",n)},expression:"p.checked"}},[e._v(e._s(i.name))])})],2)})],2)}),1)],1)])},i=[],r=t("75fc"),o=(t("7514"),t("ac6a"),t("96cf"),t("3b8d")),a={components:{},data:function(){return{apps:[],code:"",activecodes:["1"],keyword:"",systemSelect:""}},mounted:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var n,t,c,i,o,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$http.get("/base/api/App/AppDeatil"),c=this.$http.get("/base/api/Role/GetPermission?id=".concat(this.$route.params.roleid)),e.next=4,t;case 4:return i=e.sent,e.next=7,c;case 7:o=e.sent,i.forEach(function(e){e.checked=!1,e.indeterminate=!1,e.modules.forEach(function(e){e.indeterminate=!1,e.checked=!1,e.permissions.forEach(function(e){e.checked=!1})})}),o.forEach(function(e){var n=i.find(function(n){return n.code==e.appCode});e.modules.forEach(function(e){var t=n.modules.find(function(n){return n.id==e.moduleId});e.permissions.forEach(function(e){var n=t.permissions.find(function(n){return n.id==e.permissionId});n.checked=!0}),t.checked=!0,a.checkmoduleAll(t)}),n.checked=!0,a.checkappAll(n)}),(n=this.apps).push.apply(n,Object(r["a"])(i)),this.activecodes=i.map(function(e){return e.code});case 12:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),computed:{filterapps:function(){var e=this;return this.code?this.apps.filter(function(n){return n.code==e.code}):this.apps}},methods:{flush:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),checkapp:function(e){e.indeterminate=!1,e.modules.forEach(function(n){n.indeterminate=!1,n.checked=e.checked,n.permissions.forEach(function(n){n.checked=e.checked})})},checkmodule:function(e,n){e.indeterminate=!1,e.checked&&(n.checked=e.checked),e.permissions.forEach(function(n){n.checked=e.checked}),this.checkappAll(n)},checkmoduleAll:function(e,n){if(e.permissions.length){var t=e.permissions.filter(function(e){return e.checked}).length;t?t==e.permissions.length?(e.indeterminate=!1,e.checked=!0):e.indeterminate=!0:(e.indeterminate=!1,e.checked=!1),n&&this.checkappAll(n)}},checkappAll:function(e){if(e.modules.length){var n=e.modules.filter(function(e){return e.checked&&!e.indeterminate}).length;if(n&&e.modules.length==n)return e.indeterminate=!1,void(e.checked=!0);if(n=e.modules.filter(function(e){return!e.checked&&!e.indeterminate}).length,n&&e.modules.length==n)return e.indeterminate=!1,void(e.checked=!1);e.indeterminate=!0}},save:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=[],this.apps.forEach(function(e){if(e.checked||e.indeterminate){var t={appCode:e.code,modules:[]};e.modules.forEach(function(e){if(e.checked||e.indeterminate){var n={moduleId:e.id,permissions:[]};e.permissions.forEach(function(e){e.checked&&n.permissions.push({permissionId:e.id})}),t.modules.push(n)}}),n.push(t)}}),console.log(n),e.next=5,this.$http.post("/base/api/Role/SetPermission?id=".concat(this.$route.params.roleid),n);case 5:this.$message({showClose:!0,type:"success",message:"保存成功!"});case 6:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),back:function(){this.$store.commit("tab/closeAndTo",{fullPath:"/home/role"})}}},s=a,u=(t("3adf"),t("2877")),d=Object(u["a"])(s,c,i,!1,null,"efd1a1f4",null);d.options.__file="RolePermissionMap.vue";n["default"]=d.exports},"1af6":function(e,n,t){var c=t("63b6");c(c.S,"Array",{isArray:t("9003")})},"20fd":function(e,n,t){"use strict";var c=t("d9f6"),i=t("aebd");e.exports=function(e,n,t){n in e?c.f(e,n,i(0,t)):e[n]=t}},"3adf":function(e,n,t){"use strict";var c=t("501e"),i=t.n(c);i.a},"501e":function(e,n,t){},"549b":function(e,n,t){"use strict";var c=t("d864"),i=t("63b6"),r=t("241e"),o=t("b0dc"),a=t("3702"),s=t("b447"),u=t("20fd"),d=t("7cd6");i(i.S+i.F*!t("4ee1")(function(e){Array.from(e)}),"Array",{from:function(e){var n,t,i,l,f=r(e),p="function"==typeof this?this:Array,h=arguments.length,m=h>1?arguments[1]:void 0,k=void 0!==m,v=0,b=d(f);if(k&&(m=c(m,h>2?arguments[2]:void 0,2)),void 0==b||p==Array&&a(b))for(n=s(f.length),t=new p(n);n>v;v++)u(t,v,k?m(f[v],v):f[v]);else for(l=b.call(f),t=new p;!(i=l.next()).done;v++)u(t,v,k?o(l,m,[i.value,v],!0):i.value);return t.length=v,t}})},"54a1":function(e,n,t){t("6c1c"),t("1654"),e.exports=t("95d5")},"75fc":function(e,n,t){"use strict";var c=t("a745"),i=t.n(c);function r(e){if(i()(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}var o=t("774e"),a=t.n(o),s=t("c8bb"),u=t.n(s);function d(e){if(u()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return a()(e)}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(e){return r(e)||d(e)||l()}t.d(n,"a",function(){return f})},"774e":function(e,n,t){e.exports=t("d2d5")},"95d5":function(e,n,t){var c=t("40c3"),i=t("5168")("iterator"),r=t("481b");e.exports=t("584a").isIterable=function(e){var n=Object(e);return void 0!==n[i]||"@@iterator"in n||r.hasOwnProperty(c(n))}},a745:function(e,n,t){e.exports=t("f410")},c8bb:function(e,n,t){e.exports=t("54a1")},d2d5:function(e,n,t){t("1654"),t("549b"),e.exports=t("584a").Array.from},f410:function(e,n,t){t("1af6"),e.exports=t("584a").Array.isArray}}]);
//# sourceMappingURL=chunk-c1443b62.04f154da.js.map